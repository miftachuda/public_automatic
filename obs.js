var _0x4c16cb=_0x18db;(function(_0x3b7e27,_0x3b1795){var _0x4adc13=_0x18db,_0x52f355=_0x3b7e27();while(!![]){try{var _0x233a8f=parseInt(_0x4adc13(0x113))/0x1+-parseInt(_0x4adc13(0xdd))/0x2+-parseInt(_0x4adc13(0x121))/0x3+-parseInt(_0x4adc13(0xf8))/0x4+parseInt(_0x4adc13(0x103))/0x5+-parseInt(_0x4adc13(0x117))/0x6*(parseInt(_0x4adc13(0x105))/0x7)+parseInt(_0x4adc13(0xde))/0x8;if(_0x233a8f===_0x3b1795)break;else _0x52f355['push'](_0x52f355['shift']());}catch(_0x3477f6){_0x52f355['push'](_0x52f355['shift']());}}}(_0x2bab,0x23d75));const fs=require(_0x4c16cb(0x101)),lodash=require(_0x4c16cb(0xf3)),moment=require(_0x4c16cb(0x10b));var axios=require(_0x4c16cb(0xfc)),chalk=require(_0x4c16cb(0x100)),qs=require('qs');function _0x18db(_0x47db84,_0x12266b){var _0x2babc9=_0x2bab();return _0x18db=function(_0x18db67,_0x460c31){_0x18db67=_0x18db67-0xad;var _0x2daa52=_0x2babc9[_0x18db67];return _0x2daa52;},_0x18db(_0x47db84,_0x12266b);}require(_0x4c16cb(0x102));const inquirer=require('inquirer');inquirer[_0x4c16cb(0xee)]('date',require(_0x4c16cb(0xb0)));function _0x2bab(){var _0x337e05=['Failed\x20to\x20Get\x20Schedule\x20History','status','sync','1010','lodash','Failed\x20Save\x20Schedule','Last\x20value\x20not\x20available\x20please\x20choose\x20resync\x20mode','number','04:00','254196vNNEBz','yes','equipment','002','axios','short','Failed\x20Save\x20Last\x20Value','Jadwal\x20syncron\x20:\x20','chalk','fs/promises','colors','1459615lYzFIT','Sucessfully\x20Get\x20Last\x20Value','11053aWDvhi','writeFile','Sucessfully\x20Save\x20Record\x20Data','shift','data','026','moment','20:00','Sucessfully\x20Login\x20to\x20server','concat','08:00','get','date','./schedule.json','161010BLIdas','reduce','log','input','618QOiTBy','https://apps.pertamina.com/bocpp-v2.0/api/logins?secretKey=ee8fbc9dfa034db4a2419bfb4bfa9562','post','resync\x20schedule','toString','schedule.json','application/x-www-form-urlencoded','stringify','023','resync\x20all','322080eqKuAq','allan.syahputra','Schedule\x20not\x20available\x20please\x20choose\x20resync\x20mode','Upload\x20canceled','unit','inquirer-date-prompt','green','length','pertamina','Sucessfully\x20Save\x20Last\x20Value','Sucessfully\x20Save\x20Schedule','Sucessfully\x20Get\x20Schedule\x20History','forEach','muhammad.aulya','024','catch','parentRecord','rfid','\x20Equip\x20Record\x20Ready\x20to\x20send','list','Pertamina75290675','Data\x20ready\x20to\x20Send,\x20are\x20you\x20sure\x20to\x20upload\x20:','Running','Waktu\x20delay\x20antar\x20equipment\x20:','16:00','lastvalue.json','keys','filter','delay','timestamp','then','https://apps.pertamina.com/bocpp-v2.0/api/scheduleHistories?ru=R401&area=LOC-II','Send\x20Login\x20key....','2-digit','Uploading\x20Record\x20Data...','Pilih\x20unit\x20:','scanner','red','Request\x20Schedule\x20History,\x20Please\x20Wait....','Waktu\x20sync\x20Equipment\x20terakhir\x20:\x20','value','format','tosend.json','application/json','Bearer\x20','resync\x20last\x20value','bold','Pertaminaru4','blue','synctime','229922CWpLIV','1139032viiBBN','021','skip','YYYY-MM-DD\x20HH:mm:ss','map','Masukan\x20nama\x20scanner\x20:','token','prompt','Failed\x20to\x20Login\x20Something\x20Wrong','022','Failed\x20to\x20get\x20Last\x20Value\x20Record','./lastvalue.json','https://apps.pertamina.com/bocpp-v2.0/api/lastValueRecords?bocpp=boc&ru=R401&area=LOC-II','idEquipment','041','Pilih\x20jadwal\x20waktu\x20:','registerPrompt'];_0x2bab=function(){return _0x337e05;};return _0x2bab();}var synctime,unit,shift,delay,scanner,mode,lastvalue,schedule;async function getInput(){var _0x2457f8=_0x4c16cb;scanner=await inquirer[_0x2457f8(0xe5)]([{'type':_0x2457f8(0x116),'name':_0x2457f8(0xcf),'message':_0x2457f8(0xe3),'filter'(_0x41ad04){return _0x41ad04;}}])[_0x2457f8(0xc9)](_0x5d68ea=>{var _0x16b05b=_0x2457f8;return _0x5d68ea[_0x16b05b(0xcf)];}),unit=await inquirer['prompt']([{'type':_0x2457f8(0xbe),'name':_0x2457f8(0xaf),'message':_0x2457f8(0xce),'choices':[_0x2457f8(0xfb),_0x2457f8(0xdf),_0x2457f8(0xe7),_0x2457f8(0x11f),_0x2457f8(0xb9),'025',_0x2457f8(0xec)],'filter'(_0x2d1fb2){return _0x2d1fb2;}}])['then'](_0x17842c=>{var _0x3f516c=_0x2457f8;return _0x17842c[_0x3f516c(0xaf)];}),shift=await inquirer[_0x2457f8(0xe5)]([{'type':_0x2457f8(0xbe),'name':'shift','message':_0x2457f8(0xed),'choices':['00:00',_0x2457f8(0xf7),_0x2457f8(0x10f),'12:00',_0x2457f8(0xc3),_0x2457f8(0x10c)],'filter'(_0x5a8bf5){return _0x5a8bf5;}}])[_0x2457f8(0xc9)](_0x5a6c02=>{var _0x15b7bb=_0x2457f8;return _0x5a6c02[_0x15b7bb(0x108)];}),synctime=await inquirer[_0x2457f8(0xe5)]([{'type':_0x2457f8(0x111),'name':_0x2457f8(0xdc),'message':'Pilih\x20waktu\x20syncron\x20:','format':{'month':_0x2457f8(0xfd),'hour':_0x2457f8(0xcc),'minute':_0x2457f8(0xcc),'hour12':![]},'transformer':_0x1339d8=>chalk[_0x2457f8(0xd9)][_0x2457f8(0xd0)](_0x1339d8),'filter'(_0x108654){return _0x108654;}}])['then'](_0x3413f5=>{var _0x47d9fd=_0x2457f8;return _0x3413f5[_0x47d9fd(0xdc)];}),delay=await inquirer[_0x2457f8(0xe5)]([{'type':_0x2457f8(0xf6),'name':_0x2457f8(0xc7),'message':_0x2457f8(0xc2),'filter'(_0x2698de){return _0x2698de;}}])[_0x2457f8(0xc9)](_0x35d27c=>{var _0xb7ef63=_0x2457f8;return _0x35d27c[_0xb7ef63(0xc7)];}),mode=await inquirer[_0x2457f8(0xe5)]([{'type':'list','name':'mode','message':'Pilih\x20mode\x20data\x20:','choices':[_0x2457f8(0xe0),'resync\x20all','resync\x20last\x20value',_0x2457f8(0x11a)],'filter'(_0x49ff6c){return _0x49ff6c;}}])[_0x2457f8(0xc9)](_0x348a55=>{return _0x348a55['mode'];});}async function fire(){var _0xc58598=_0x4c16cb,_0x5795f0;switch(scanner){case _0xc58598(0xb8):_0x5795f0=_0xc58598(0xbf);break;case _0xc58598(0x122):_0x5795f0=_0xc58598(0xda);break;}var _0x20d8d6=async function(){var _0x52efb6=_0xc58598,_0x295491=qs[_0x52efb6(0x11e)]({'username':scanner,'password':_0x5795f0,'companyCode':_0x52efb6(0xf2),'domainName':_0x52efb6(0xb3)}),_0x1c8ad9={'method':_0x52efb6(0x119),'url':_0x52efb6(0x118),'headers':{'Content-Type':_0x52efb6(0x11d)},'data':_0x295491};return console[_0x52efb6(0x115)](_0x52efb6(0xcb)),axios(_0x1c8ad9)[_0x52efb6(0xc9)](function(_0x18a242){var _0x41ca10=_0x52efb6;return console[_0x41ca10(0x115)](_0x41ca10(0x10d)['green']),_0x18a242['data'][_0x41ca10(0xe4)];})['catch'](function(_0x22f6bd){var _0x1bda8=_0x52efb6;console[_0x1bda8(0x115)](_0x1bda8(0xe6)[_0x1bda8(0xd0)]);});},_0xd45f06=async function(_0x5b40d3){var _0x543853=_0xc58598,_0x2c919c={'method':_0x543853(0x110),'url':_0x543853(0xea),'headers':{'Authorization':_0x543853(0xd7)+_0x5b40d3}};return console['log']('Request\x20Last\x20Value,\x20Please\x20Wait....'),axios(_0x2c919c)[_0x543853(0xc9)](function(_0x40d2c2){var _0x29901a=_0x543853;return console[_0x29901a(0x115)](_0x29901a(0x104)['green']),_0x40d2c2[_0x29901a(0x109)];})[_0x543853(0xba)](function(_0x56cd0a){var _0x3283fa=_0x543853;console[_0x3283fa(0x115)](_0x3283fa(0xe8)[_0x3283fa(0xd0)]),runit();});},_0xb469fd=async function(_0x5eb210){var _0x2ad41f=_0xc58598,_0x7f9383={'method':_0x2ad41f(0x110),'url':_0x2ad41f(0xca),'headers':{'Authorization':_0x2ad41f(0xd7)+_0x5eb210}};return console[_0x2ad41f(0x115)](_0x2ad41f(0xd1)),axios(_0x7f9383)[_0x2ad41f(0xc9)](function(_0x1912dc){var _0x55c332=_0x2ad41f;return console[_0x55c332(0x115)](_0x55c332(0xb6)[_0x55c332(0xb1)]),_0x1912dc['data'];})[_0x2ad41f(0xba)](function(_0x3703f4){var _0x526a56=_0x2ad41f;console[_0x526a56(0x115)](_0x526a56(0xef)[_0x526a56(0xd0)]),runit();});};let _0x41a92e=!![];const _0x16f227=await _0x20d8d6();function _0x2bafc9(_0x476594,_0x2e8fc1){try{return _0x41a92e=!![],require(_0x476594);}catch(_0x2b0a39){return console['log'](_0x2e8fc1),_0x41a92e=![],![];}}switch(mode){case _0xc58598(0xe0):lastvalue=_0x2bafc9(_0xc58598(0xe9),_0xc58598(0xf5)),schedule=_0x2bafc9(_0xc58598(0x112),'Schedule\x20not\x20available\x20please\x20choose\x20resync\x20mode');break;case _0xc58598(0x120):lastvalue=await _0xd45f06(_0x16f227),fs['writeFile'](_0xc58598(0xc4),JSON[_0xc58598(0x11e)](lastvalue))[_0xc58598(0xc9)](function(_0x5d03bf){var _0x158ab=_0xc58598;console[_0x158ab(0x115)](_0x158ab(0xb4)[_0x158ab(0xb1)]);})['catch'](function(_0x27f154){var _0x5554a9=_0xc58598;console['log'](_0x5554a9(0xfe)[_0x5554a9(0xd0)]);}),schedule=await _0xb469fd(_0x16f227),fs['writeFile'](_0xc58598(0x11c),JSON[_0xc58598(0x11e)](schedule))[_0xc58598(0xc9)](function(_0x39e7dd){var _0x5c154c=_0xc58598;console[_0x5c154c(0x115)](_0x5c154c(0xb5)['green']);})[_0xc58598(0xba)](function(_0x44b9c5){var _0x520cac=_0xc58598;console['log'](_0x520cac(0xf4)[_0x520cac(0xd0)]);});break;case _0xc58598(0xd8):lastvalue=await _0xd45f06(_0x16f227),fs[_0xc58598(0x106)](_0xc58598(0xc4),JSON[_0xc58598(0x11e)](lastvalue))['then'](function(_0x791b93){var _0x593f04=_0xc58598;console[_0x593f04(0x115)](_0x593f04(0xb4)['green']);})[_0xc58598(0xba)](function(_0x15ef7d){var _0x2dc93e=_0xc58598;console[_0x2dc93e(0x115)]('Failed\x20Save\x20Last\x20Value'[_0x2dc93e(0xd0)]);}),schedule=_0x2bafc9(_0xc58598(0x112),_0xc58598(0xad));break;case _0xc58598(0x11a):lastvalue=_0x2bafc9(_0xc58598(0xe9),_0xc58598(0xf5)),schedule=await _0xb469fd(_0x16f227),fs[_0xc58598(0x106)](_0xc58598(0x11c),JSON[_0xc58598(0x11e)](schedule))[_0xc58598(0xc9)](function(_0x2e2ae8){var _0x27a922=_0xc58598;console[_0x27a922(0x115)](_0x27a922(0xb5)[_0x27a922(0xb1)]);})['catch'](function(_0x53dc04){var _0x3eaddf=_0xc58598;console[_0x3eaddf(0x115)](_0x3eaddf(0xf4)[_0x3eaddf(0xd0)]);});break;}if(_0x41a92e){var _0x4b3247=lodash(schedule)[_0xc58598(0xc6)]({'unit':unit,'shift':shift,'status':'Running'})['value'](),_0x16165d=schedule[_0xc58598(0xc6)](_0x5a3c31=>{var _0x1df282=_0xc58598;return _0x5a3c31[_0x1df282(0xaf)]==_0x1df282(0x10a)||_0x5a3c31[_0x1df282(0xaf)]=='024'&&_0x5a3c31[_0x1df282(0x108)]==shift&&_0x5a3c31[_0x1df282(0xf0)]==_0x1df282(0xc1);}),_0x5231e9=_0x4b3247[_0xc58598(0xe2)](_0x1a6216=>{var _0x30ec57=_0xc58598;synctime=moment(synctime);function _0x3171e6(_0x3e5cde,_0x516c27){return _0x3e5cde+_0x516c27*0x3e8;}var _0x3c5a37=lodash(lastvalue)['filter']({'idEquipment':_0x1a6216[_0x30ec57(0xeb)]})['value'](),_0x148201=Object[_0x30ec57(0xc5)](_0x3c5a37)[_0x30ec57(0x114)](function(_0x4bc2e2,_0x50bbcb){var _0x25e2cf=_0x30ec57;return _0x4bc2e2[_0x25e2cf(0x10e)](_0x3c5a37[_0x50bbcb]);},[]),_0x207305=_0x3171e6(synctime,delay),_0x461367=moment(_0x207305)[_0x30ec57(0xd4)](_0x30ec57(0xe1))[_0x30ec57(0x11b)](),_0x2287dd=moment(_0x207305)['format']('HH:mm:ss')[_0x30ec57(0x11b)]();return synctime=_0x207305,_0x148201['map'](_0x35b9b4=>{var _0x1ed54b=_0x30ec57;return{'idScheduleHistory':_0x1a6216['id'],'parentRecord':_0x1a6216[_0x1ed54b(0xbb)],'value':_0x35b9b4[_0x1ed54b(0xd3)],'idParameter':_0x35b9b4['idParameter'],'scanWith':_0x1ed54b(0xbc),'timestamp':_0x461367,'scanBy':scanner,'approved':0x0,'shift':_0x2287dd,'notesRecord':''};});}),_0x39c2bf=Object['keys'](_0x5231e9)[_0xc58598(0x114)](function(_0x41fc25,_0x34e0f1){var _0x3e563c=_0xc58598;return _0x41fc25[_0x3e563c(0x10e)](_0x5231e9[_0x34e0f1]);},[]);await fs[_0xc58598(0x106)](_0xc58598(0xd5),JSON[_0xc58598(0x11e)](_0x39c2bf))['then'](function(_0x15d18b){var _0x54cc31=_0xc58598;console['log'](_0x54cc31(0x107)[_0x54cc31(0xb1)]);})[_0xc58598(0xba)](function(_0x46cd9b){var _0x4dc0a4=_0xc58598;console[_0x4dc0a4(0x115)]('Failed\x20Save\x20Record\x20Data'[_0x4dc0a4(0xd0)]);});}else _0x39c2bf=null;return[_0x39c2bf,_0x16f227,_0x4b3247];}var link='https://apps.pertamina.com/bocpp-v2.0/api/equipRecords/',syncronize=async function(_0x553d48,_0x3c117d){var _0x1fd183=_0x4c16cb,_0x523e91=JSON[_0x1fd183(0x11e)](_0x553d48),_0x444aa1={'method':'post','url':link,'headers':{'Authorization':_0x1fd183(0xd7)+_0x3c117d,'Content-Type':_0x1fd183(0xd6)},'data':_0x523e91};return console['log'](_0x1fd183(0xcd)),axios(_0x444aa1)[_0x1fd183(0xc9)](function(_0x47e527){var _0x2af662=_0x1fd183;return console['log'](_0x47e527),_0x47e527[_0x2af662(0x109)];})['catch'](function(_0x2b15a8){var _0x5ee1c6=_0x1fd183;console[_0x5ee1c6(0x115)](_0x2b15a8);});},runit=async function(){var _0x122a5c=_0x4c16cb;await getInput();var _0x30ce33=await fire();_0x30ce33[0x2]!=null&&_0x30ce33[0x0]!=null?(_0x30ce33[0x2][_0x122a5c(0xb7)](_0x2f3914=>{var _0x4b8fa0=_0x122a5c;console[_0x4b8fa0(0x115)](_0x2f3914[_0x4b8fa0(0xfa)]);}),console[_0x122a5c(0x115)](Object[_0x122a5c(0xc5)](_0x30ce33[0x2])[_0x122a5c(0xb2)]+_0x122a5c(0xbd)),console['log'](_0x122a5c(0xff)+shift[_0x122a5c(0xdb)]),console[_0x122a5c(0x115)](_0x122a5c(0xd2)+_0x30ce33[0x0][_0x30ce33[0x0][_0x122a5c(0xb2)]-0x1][_0x122a5c(0xc8)][_0x122a5c(0xdb)]),sync=await inquirer[_0x122a5c(0xe5)]([{'type':_0x122a5c(0xbe),'name':'sync','message':_0x122a5c(0xc0),'choices':[_0x122a5c(0xf9),'no'],'filter'(_0xf125be){return _0xf125be;}}])[_0x122a5c(0xc9)](_0x1111a8=>{var _0x5e9980=_0x122a5c;return _0x1111a8[_0x5e9980(0xf1)]===_0x5e9980(0xf9)?console[_0x5e9980(0x115)](syncronize(_0x30ce33[0x0],_0x30ce33[0x1])[_0x5e9980(0x109)]):console[_0x5e9980(0x115)](_0x5e9980(0xae)[_0x5e9980(0xd0)]),_0x1111a8[_0x5e9980(0xf1)];})):console[_0x122a5c(0x115)]('Data\x20not\x20available'[_0x122a5c(0xd0)]);};runit();
