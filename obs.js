var _0x4746ba=_0xa615;(function(_0x8e3b6e,_0x2f0f65){var _0x5ea6c4=_0xa615,_0x3b2ee1=_0x8e3b6e();while(!![]){try{var _0x3c1fe7=parseInt(_0x5ea6c4(0x117))/0x1*(parseInt(_0x5ea6c4(0x10f))/0x2)+-parseInt(_0x5ea6c4(0x11f))/0x3+parseInt(_0x5ea6c4(0x112))/0x4*(parseInt(_0x5ea6c4(0x106))/0x5)+-parseInt(_0x5ea6c4(0xd9))/0x6*(parseInt(_0x5ea6c4(0x110))/0x7)+-parseInt(_0x5ea6c4(0xcc))/0x8+-parseInt(_0x5ea6c4(0xec))/0x9*(parseInt(_0x5ea6c4(0x115))/0xa)+-parseInt(_0x5ea6c4(0xf5))/0xb*(-parseInt(_0x5ea6c4(0xf1))/0xc);if(_0x3c1fe7===_0x2f0f65)break;else _0x3b2ee1['push'](_0x3b2ee1['shift']());}catch(_0x18d9cd){_0x3b2ee1['push'](_0x3b2ee1['shift']());}}}(_0x1645,0xcdd6d));const fs=require(_0x4746ba(0xfd)),lodash=require(_0x4746ba(0xd3)),moment=require('moment');var axios=require(_0x4746ba(0xd1)),chalk=require(_0x4746ba(0x127)),qs=require('qs');require('colors');function _0xa615(_0xd91e7f,_0x53a441){var _0x1645cb=_0x1645();return _0xa615=function(_0xa615f2,_0x4814ac){_0xa615f2=_0xa615f2-0xc4;var _0x1f31f8=_0x1645cb[_0xa615f2];return _0x1f31f8;},_0xa615(_0xd91e7f,_0x53a441);}const inquirer=require('inquirer');function _0x1645(){var _0x2fcbd6=['mode','Running','11737363DByDdH','get','https://apps.pertamina.com/bocpp-v2.0/api/scheduleHistories?ru=R401&area=LOC-II','lastvalue.json','1010','keys','scanner','026','fs/promises','./schedule.json','Send\x20Login\x20key....','Jadwal\x20syncron\x20:\x20','Sucessfully\x20Save\x20Last\x20Value','Pilih\x20jadwal\x20waktu\x20:','resync\x20last\x20value','number','status','30GZfJOg','Failed\x20to\x20get\x20Last\x20Value\x20Record','Failed\x20to\x20Get\x20Schedule\x20History','Waktu\x20sync\x20Equipment\x20terakhir\x20:\x20','YYYY-MM-DD\x20HH:mm:ss','rfid','muhammad.aulya','application/x-www-form-urlencoded','sync','1946pILIxL','315105bvVINB','inquirer-date-prompt','468152JJReBV','025','forEach','14508610ANqxNC','https://apps.pertamina.com/bocpp-v2.0/api/lastValueRecords?bocpp=boc&ru=R401&area=LOC-II','120GeBNnb','catch','value','registerPrompt','Schedule\x20not\x20available\x20please\x20choose\x20resync\x20mode','length','idParameter','stringify','807999fxXgnk','green','delay','Last\x20value\x20not\x20available\x20please\x20choose\x20resync\x20mode','https://apps.pertamina.com/bocpp-v2.0/api/logins?secretKey=ee8fbc9dfa034db4a2419bfb4bfa9562','post','024','2-digit','chalk','20:00','Pertamina75290675','writeFile','Failed\x20Save\x20Schedule','\x20Equip\x20Record\x20Ready\x20to\x20send','Pilih\x20unit\x20:','Request\x20Schedule\x20History,\x20Please\x20Wait....','021','Failed\x20Save\x20Last\x20Value','short','equipment','04:00','idEquipment','schedule.json','resync\x20all','list','08:00','map','Masukan\x20nama\x20scanner\x20:','Upload\x20canceled','bold','Sucessfully\x20Save\x20Schedule','6866032CxMnnF','log','prompt','filter','041','axios','reduce','lodash','date','Data\x20not\x20available','https://apps.pertamina.com/bocpp-v2.0/api/equipRecords/','blue','shift','222UYccVK','unit','./lastvalue.json','022','then','002','Sucessfully\x20Get\x20Last\x20Value','synctime','yes','concat','toString','red','12:00','Sucessfully\x20Save\x20Record\x20Data','parentRecord','pertamina','token','resync\x20schedule','Bearer\x20','9MhfMoa','format','skip','Sucessfully\x20Login\x20to\x20server','data','48YpKHvI','timestamp'];_0x1645=function(){return _0x2fcbd6;};return _0x1645();}inquirer[_0x4746ba(0x11a)](_0x4746ba(0xd4),require(_0x4746ba(0x111)));var synctime,unit,shift,delay,scanner,mode,lastvalue,schedule;async function getInput(){var _0x2cbf9b=_0x4746ba;username=_0x2cbf9b(0x10c),password=_0x2cbf9b(0x129),scanner=await inquirer['prompt']([{'type':'input','name':_0x2cbf9b(0xfb),'message':_0x2cbf9b(0xc8),'filter'(_0x2885d4){return _0x2885d4;}}])['then'](_0x224104=>{var _0x419e77=_0x2cbf9b;return _0x224104[_0x419e77(0xfb)];}),unit=await inquirer[_0x2cbf9b(0xce)]([{'type':_0x2cbf9b(0xc5),'name':_0x2cbf9b(0xda),'message':_0x2cbf9b(0x12d),'choices':[_0x2cbf9b(0xde),_0x2cbf9b(0x12f),_0x2cbf9b(0xdc),'023',_0x2cbf9b(0x125),_0x2cbf9b(0x113),_0x2cbf9b(0xd0)],'filter'(_0x1e4887){return _0x1e4887;}}])[_0x2cbf9b(0xdd)](_0x45252b=>{var _0x23c5f3=_0x2cbf9b;return _0x45252b[_0x23c5f3(0xda)];}),shift=await inquirer[_0x2cbf9b(0xce)]([{'type':'list','name':'shift','message':_0x2cbf9b(0x102),'choices':['00:00',_0x2cbf9b(0x133),_0x2cbf9b(0xc6),_0x2cbf9b(0xe5),'16:00',_0x2cbf9b(0x128)],'filter'(_0x323044){return _0x323044;}}])[_0x2cbf9b(0xdd)](_0x3ce756=>{var _0x3d1573=_0x2cbf9b;return _0x3ce756[_0x3d1573(0xd8)];}),synctime=await inquirer[_0x2cbf9b(0xce)]([{'type':_0x2cbf9b(0xd4),'name':_0x2cbf9b(0xe0),'message':'Pilih\x20waktu\x20syncron\x20:','format':{'month':_0x2cbf9b(0x131),'hour':'2-digit','minute':_0x2cbf9b(0x126),'hour12':![]},'transformer':_0x5b5588=>chalk[_0x2cbf9b(0xca)]['red'](_0x5b5588),'filter'(_0x5eedc1){return _0x5eedc1;}}])['then'](_0xcb9935=>{var _0x3bbd27=_0x2cbf9b;return _0xcb9935[_0x3bbd27(0xe0)];}),delay=await inquirer[_0x2cbf9b(0xce)]([{'type':_0x2cbf9b(0x104),'name':_0x2cbf9b(0x121),'message':'Waktu\x20delay\x20antar\x20equipment\x20:','filter'(_0x35e38b){return _0x35e38b;}}])[_0x2cbf9b(0xdd)](_0x1151d6=>{var _0x21b3f6=_0x2cbf9b;return _0x1151d6[_0x21b3f6(0x121)];}),mode=await inquirer[_0x2cbf9b(0xce)]([{'type':_0x2cbf9b(0xc5),'name':_0x2cbf9b(0xf3),'message':'Pilih\x20mode\x20data\x20:','choices':[_0x2cbf9b(0xee),_0x2cbf9b(0xc4),_0x2cbf9b(0x103),_0x2cbf9b(0xea)],'filter'(_0x49c4aa){return _0x49c4aa;}}])[_0x2cbf9b(0xdd)](_0x9092ea=>{var _0x56b4bb=_0x2cbf9b;return _0x9092ea[_0x56b4bb(0xf3)];});}async function fire(){var _0x3db337=_0x4746ba,_0x2ebadd=async function(){var _0x3c474f=_0xa615,_0x1bc440=qs[_0x3c474f(0x11e)]({'username':username,'password':password,'companyCode':_0x3c474f(0xf9),'domainName':_0x3c474f(0xe8)}),_0xc3a3aa={'method':'post','url':_0x3c474f(0x123),'headers':{'Content-Type':_0x3c474f(0x10d)},'data':_0x1bc440};return console['log'](_0x3c474f(0xff)),axios(_0xc3a3aa)[_0x3c474f(0xdd)](function(_0x4f9b79){var _0x27d71a=_0x3c474f;return console[_0x27d71a(0xcd)](_0x27d71a(0xef)['green']),_0x4f9b79['data'][_0x27d71a(0xe9)];})[_0x3c474f(0x118)](function(_0x384424){var _0x159530=_0x3c474f;console[_0x159530(0xcd)]('Failed\x20to\x20Login\x20Something\x20Wrong'['red']);});},_0x18b892=async function(_0x46eb91){var _0x594bc7=_0xa615,_0x1e093={'method':_0x594bc7(0xf6),'url':_0x594bc7(0x116),'headers':{'Authorization':_0x594bc7(0xeb)+_0x46eb91}};return console[_0x594bc7(0xcd)]('Request\x20Last\x20Value,\x20Please\x20Wait....'),axios(_0x1e093)[_0x594bc7(0xdd)](function(_0x5e0003){var _0x26316a=_0x594bc7;return console[_0x26316a(0xcd)](_0x26316a(0xdf)['green']),_0x5e0003[_0x26316a(0xf0)];})[_0x594bc7(0x118)](function(_0x287132){var _0x31d406=_0x594bc7;console[_0x31d406(0xcd)](_0x31d406(0x107)[_0x31d406(0xe4)]),runit();});},_0x5c75cd=async function(_0x2f1658){var _0x309bbf=_0xa615,_0x123b2a={'method':'get','url':_0x309bbf(0xf7),'headers':{'Authorization':_0x309bbf(0xeb)+_0x2f1658}};return console['log'](_0x309bbf(0x12e)),axios(_0x123b2a)[_0x309bbf(0xdd)](function(_0x59994b){var _0x2fff9f=_0x309bbf;return console['log']('Sucessfully\x20Get\x20Schedule\x20History'[_0x2fff9f(0x120)]),_0x59994b[_0x2fff9f(0xf0)];})[_0x309bbf(0x118)](function(_0x57222b){var _0x2d7f1f=_0x309bbf;console[_0x2d7f1f(0xcd)](_0x2d7f1f(0x108)['red']),runit();});};let _0x5030b2=!![];const _0xb738ef=await _0x2ebadd();function _0xadce4f(_0x328567,_0x1d7672){var _0x4cfa0f=_0xa615;try{return _0x5030b2=!![],require(_0x328567);}catch(_0x27d070){return console[_0x4cfa0f(0xcd)](_0x1d7672),_0x5030b2=![],![];}}switch(mode){case _0x3db337(0xee):lastvalue=_0xadce4f('./lastvalue.json',_0x3db337(0x122)),schedule=_0xadce4f('./schedule.json',_0x3db337(0x11b));break;case'resync\x20all':lastvalue=await _0x18b892(_0xb738ef),fs[_0x3db337(0x12a)](_0x3db337(0xf8),JSON['stringify'](lastvalue))[_0x3db337(0xdd)](function(_0xdb696f){var _0x5dbeaa=_0x3db337;console[_0x5dbeaa(0xcd)](_0x5dbeaa(0x101)['green']);})[_0x3db337(0x118)](function(_0x413fb9){var _0x39c888=_0x3db337;console[_0x39c888(0xcd)](_0x39c888(0x130)['red']);}),schedule=await _0x5c75cd(_0xb738ef),fs[_0x3db337(0x12a)]('schedule.json',JSON[_0x3db337(0x11e)](schedule))[_0x3db337(0xdd)](function(_0x25ee1c){var _0x4af86a=_0x3db337;console[_0x4af86a(0xcd)](_0x4af86a(0xcb)[_0x4af86a(0x120)]);})['catch'](function(_0x43ee57){var _0x39852d=_0x3db337;console['log'](_0x39852d(0x12b)[_0x39852d(0xe4)]);});break;case _0x3db337(0x103):lastvalue=await _0x18b892(_0xb738ef),fs[_0x3db337(0x12a)](_0x3db337(0xf8),JSON['stringify'](lastvalue))[_0x3db337(0xdd)](function(_0x515d77){var _0x2d3ef1=_0x3db337;console['log'](_0x2d3ef1(0x101)['green']);})[_0x3db337(0x118)](function(_0x9619af){var _0x3414fb=_0x3db337;console[_0x3414fb(0xcd)](_0x3414fb(0x130)[_0x3414fb(0xe4)]);}),schedule=_0xadce4f(_0x3db337(0xfe),_0x3db337(0x11b));break;case _0x3db337(0xea):lastvalue=_0xadce4f(_0x3db337(0xdb),_0x3db337(0x122)),schedule=await _0x5c75cd(_0xb738ef),fs[_0x3db337(0x12a)](_0x3db337(0x135),JSON['stringify'](schedule))[_0x3db337(0xdd)](function(_0x362110){console['log']('Sucessfully\x20Save\x20Schedule'['green']);})[_0x3db337(0x118)](function(_0x4c13fe){var _0x280710=_0x3db337;console[_0x280710(0xcd)](_0x280710(0x12b)[_0x280710(0xe4)]);});break;}if(_0x5030b2){var _0x18c679=lodash(schedule)[_0x3db337(0xcf)]({'unit':unit,'shift':shift,'status':_0x3db337(0xf4)})[_0x3db337(0x119)](),_0x430e82=schedule['filter'](_0x3a6573=>{var _0x570c52=_0x3db337;return _0x3a6573[_0x570c52(0xda)]==_0x570c52(0xfc)||_0x3a6573[_0x570c52(0xda)]==_0x570c52(0x125)&&_0x3a6573[_0x570c52(0xd8)]==shift&&_0x3a6573[_0x570c52(0x105)]==_0x570c52(0xf4);}),_0x509e79=_0x18c679['map'](_0x4a3c11=>{var _0x29113f=_0x3db337;synctime=moment(synctime);function _0x13da25(_0x46fc8f,_0x33eec6){return _0x46fc8f+_0x33eec6*0x3e8;}var _0x49db1d=lodash(lastvalue)[_0x29113f(0xcf)]({'idEquipment':_0x4a3c11[_0x29113f(0x134)]})[_0x29113f(0x119)](),_0x36cd49=Object['keys'](_0x49db1d)[_0x29113f(0xd2)](function(_0x28f762,_0x594636){var _0x4fd9d3=_0x29113f;return _0x28f762[_0x4fd9d3(0xe2)](_0x49db1d[_0x594636]);},[]),_0x393dcd=_0x13da25(synctime,delay),_0x4fccb9=moment(_0x393dcd)[_0x29113f(0xed)](_0x29113f(0x10a))[_0x29113f(0xe3)](),_0x4797b5=moment(_0x393dcd)['format']('HH:mm:ss')[_0x29113f(0xe3)]();return synctime=_0x393dcd,_0x36cd49[_0x29113f(0xc7)](_0x576451=>{var _0x2c697c=_0x29113f;return{'idScheduleHistory':_0x4a3c11['id'],'parentRecord':_0x4a3c11[_0x2c697c(0xe7)],'value':_0x576451[_0x2c697c(0x119)],'idParameter':_0x576451[_0x2c697c(0x11d)],'scanWith':_0x2c697c(0x10b),'timestamp':_0x4fccb9,'scanBy':scanner,'approved':0x0,'shift':_0x4797b5,'notesRecord':''};});}),_0x3303cb=Object[_0x3db337(0xfa)](_0x509e79)[_0x3db337(0xd2)](function(_0x25e1e0,_0xb6ceb){var _0x582c16=_0x3db337;return _0x25e1e0[_0x582c16(0xe2)](_0x509e79[_0xb6ceb]);},[]);await fs[_0x3db337(0x12a)]('tosend.json',JSON[_0x3db337(0x11e)](_0x3303cb))[_0x3db337(0xdd)](function(_0x3be6df){var _0xe0ec2b=_0x3db337;console[_0xe0ec2b(0xcd)](_0xe0ec2b(0xe6)[_0xe0ec2b(0x120)]);})[_0x3db337(0x118)](function(_0x11b298){var _0xb0dcfd=_0x3db337;console[_0xb0dcfd(0xcd)]('Failed\x20Save\x20Record\x20Data'[_0xb0dcfd(0xe4)]);});}else _0x3303cb=null;return[_0x3303cb,_0xb738ef,_0x18c679];}var link=_0x4746ba(0xd6),link2='https://apps.pertamina.com/bocpp-v2.0/api/equipRecord/',syncronize=async function(_0x55cb44,_0x115d9e){var _0x460bf4=_0x4746ba,_0x4b3535=JSON[_0x460bf4(0x11e)](_0x55cb44),_0x25e03e={'method':_0x460bf4(0x124),'url':link,'headers':{'Authorization':_0x460bf4(0xeb)+_0x115d9e,'Content-Type':'application/json'},'data':_0x4b3535};return console[_0x460bf4(0xcd)]('Uploading\x20Record\x20Data...'),axios(_0x25e03e)[_0x460bf4(0xdd)](function(_0xaf9a69){var _0x36331a=_0x460bf4;return console['log'](_0xaf9a69),_0xaf9a69[_0x36331a(0xf0)];})['catch'](function(_0x4f7d3a){var _0x4a32f7=_0x460bf4;console[_0x4a32f7(0xcd)](_0x4f7d3a);});},runit=async function(){var _0x1b7438=_0x4746ba;await getInput();var _0x3dc6aa=await fire();_0x3dc6aa[0x2]!=null&&_0x3dc6aa[0x0]!=null?(_0x3dc6aa[0x2][_0x1b7438(0x114)](_0x5d5b15=>{var _0x3aa6a9=_0x1b7438;console[_0x3aa6a9(0xcd)](_0x5d5b15[_0x3aa6a9(0x132)]);}),console[_0x1b7438(0xcd)](Object[_0x1b7438(0xfa)](_0x3dc6aa[0x2])[_0x1b7438(0x11c)]+_0x1b7438(0x12c)),console['log'](_0x1b7438(0x100)+shift[_0x1b7438(0xd7)]),console[_0x1b7438(0xcd)](_0x1b7438(0x109)+_0x3dc6aa[0x0][_0x3dc6aa[0x0][_0x1b7438(0x11c)]-0x1][_0x1b7438(0xf2)][_0x1b7438(0xd7)]),sync=await inquirer[_0x1b7438(0xce)]([{'type':_0x1b7438(0xc5),'name':_0x1b7438(0x10e),'message':'Data\x20ready\x20to\x20Send,\x20are\x20you\x20sure\x20to\x20upload\x20:','choices':[_0x1b7438(0xe1),'no'],'filter'(_0x3781fb){return _0x3781fb;}}])[_0x1b7438(0xdd)](_0x4015c9=>{var _0x7407e1=_0x1b7438;return _0x4015c9['sync']===_0x7407e1(0xe1)?(scanner!=_0x7407e1(0x10c)?link=link2:link=link,console[_0x7407e1(0xcd)](syncronize(_0x3dc6aa[0x0],_0x3dc6aa[0x1])[_0x7407e1(0xf0)])):console[_0x7407e1(0xcd)](_0x7407e1(0xc9)[_0x7407e1(0xe4)]),_0x4015c9[_0x7407e1(0x10e)];})):console['log'](_0x1b7438(0xd5)[_0x1b7438(0xe4)]);};runit();
